"use strict";

exports.__esModule = true;
exports.default = void 0;
exports.render = render;

var _popup = _interopRequireDefault(require("../popup"));

var _button = _interopRequireDefault(require("../button"));

var _props = require("./props");

var _vue = require("vue");

var _shared = require("../utils/shared");

var _locale = require("../locale");

var _components = require("../utils/components");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var {
  n,
  classes
} = (0, _components.createNamespace)('dialog');

function render(_ctx, _cache) {
  var _component_var_button = (0, _vue.resolveComponent)("var-button");

  var _component_var_popup = (0, _vue.resolveComponent)("var-popup");

  return (0, _vue.openBlock)(), (0, _vue.createBlock)(_component_var_popup, {
    class: (0, _vue.normalizeClass)(_ctx.n('popup')),
    "var-dialog-cover": "",
    show: _ctx.popupShow,
    overlay: _ctx.overlay,
    "overlay-class": _ctx.overlayClass,
    "overlay-style": _ctx.overlayStyle,
    "lock-scroll": _ctx.lockScroll,
    "close-on-click-overlay": _ctx.popupCloseOnClickOverlay,
    teleport: _ctx.teleport,
    onOpen: _ctx.onOpen,
    onClose: _ctx.onClose,
    onClosed: _ctx.onClosed,
    onOpened: _ctx.onOpened,
    onRouteChange: _ctx.onRouteChange,
    onClickOverlay: _ctx.handleClickOverlay
  }, {
    default: (0, _vue.withCtx)(() => [(0, _vue.createElementVNode)("div", (0, _vue.mergeProps)({
      class: _ctx.classes('var--box', _ctx.n(), _ctx.dialogClass),
      style: _ctx.dialogStyle
    }, _ctx.$attrs), [(0, _vue.createElementVNode)("div", {
      class: (0, _vue.normalizeClass)(_ctx.n('title'))
    }, [(0, _vue.renderSlot)(_ctx.$slots, "title", {}, () => [(0, _vue.createTextVNode)((0, _vue.toDisplayString)(_ctx.dt(_ctx.title, _ctx.pack.dialogTitle)), 1
    /* TEXT */
    )])], 2
    /* CLASS */
    ), (0, _vue.createElementVNode)("div", {
      class: (0, _vue.normalizeClass)(_ctx.n('message')),
      style: (0, _vue.normalizeStyle)({
        textAlign: _ctx.messageAlign
      })
    }, [(0, _vue.renderSlot)(_ctx.$slots, "default", {}, () => [(0, _vue.createTextVNode)((0, _vue.toDisplayString)(_ctx.message), 1
    /* TEXT */
    )])], 6
    /* CLASS, STYLE */
    ), (0, _vue.createElementVNode)("div", {
      class: (0, _vue.normalizeClass)(_ctx.n('actions'))
    }, [_ctx.cancelButton ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_var_button, {
      key: 0,
      class: (0, _vue.normalizeClass)(_ctx.classes(_ctx.n('button'), _ctx.n('cancel-button'))),
      "var-dialog-cover": "",
      text: "",
      "text-color": _ctx.cancelButtonTextColor,
      color: _ctx.cancelButtonColor,
      onClick: _ctx.cancel
    }, {
      default: (0, _vue.withCtx)(() => [(0, _vue.createTextVNode)((0, _vue.toDisplayString)(_ctx.dt(_ctx.cancelButtonText, _ctx.pack.dialogCancelButtonText)), 1
      /* TEXT */
      )]),
      _: 1
      /* STABLE */

    }, 8
    /* PROPS */
    , ["class", "text-color", "color", "onClick"])) : (0, _vue.createCommentVNode)("v-if", true), _ctx.confirmButton ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_var_button, {
      key: 1,
      class: (0, _vue.normalizeClass)(_ctx.classes(_ctx.n('button'), _ctx.n('confirm-button'))),
      "var-dialog-cover": "",
      text: "",
      "text-color": _ctx.confirmButtonTextColor,
      color: _ctx.confirmButtonColor,
      onClick: _ctx.confirm
    }, {
      default: (0, _vue.withCtx)(() => [(0, _vue.createTextVNode)((0, _vue.toDisplayString)(_ctx.dt(_ctx.confirmButtonText, _ctx.pack.dialogConfirmButtonText)), 1
      /* TEXT */
      )]),
      _: 1
      /* STABLE */

    }, 8
    /* PROPS */
    , ["class", "text-color", "color", "onClick"])) : (0, _vue.createCommentVNode)("v-if", true)], 2
    /* CLASS */
    )], 16
    /* FULL_PROPS */
    )]),
    _: 3
    /* FORWARDED */

  }, 8
  /* PROPS */
  , ["class", "show", "overlay", "overlay-class", "overlay-style", "lock-scroll", "close-on-click-overlay", "teleport", "onOpen", "onClose", "onClosed", "onOpened", "onRouteChange", "onClickOverlay"]);
}

var _default = (0, _vue.defineComponent)({
  render,
  name: 'VarDialog',
  components: {
    VarPopup: _popup.default,
    VarButton: _button.default
  },
  inheritAttrs: false,
  props: _props.props,

  setup(props) {
    var popupShow = (0, _vue.ref)(false);
    var popupCloseOnClickOverlay = (0, _vue.ref)(false);

    var done = () => (0, _components.call)(props['onUpdate:show'], false);

    var handleClickOverlay = () => {
      var {
        closeOnClickOverlay,
        onClickOverlay,
        onBeforeClose
      } = props;
      (0, _components.call)(onClickOverlay);

      if (!closeOnClickOverlay) {
        return;
      }

      if (onBeforeClose != null) {
        onBeforeClose('close', done);
        return;
      }

      (0, _components.call)(props['onUpdate:show'], false);
    };

    var confirm = () => {
      var {
        onBeforeClose,
        onConfirm
      } = props;
      (0, _components.call)(onConfirm);

      if (onBeforeClose != null) {
        onBeforeClose('confirm', done);
        return;
      }

      (0, _components.call)(props['onUpdate:show'], false);
    };

    var cancel = () => {
      var {
        onBeforeClose,
        onCancel
      } = props;
      (0, _components.call)(onCancel);

      if (onBeforeClose != null) {
        onBeforeClose('cancel', done);
        return;
      }

      (0, _components.call)(props['onUpdate:show'], false);
    };

    (0, _vue.watch)(() => props.show, newValue => {
      popupShow.value = newValue;
    }, {
      immediate: true
    });
    (0, _vue.watch)(() => props.closeOnClickOverlay, newValue => {
      if (props.onBeforeClose != null) {
        popupCloseOnClickOverlay.value = false;
        return;
      }

      popupCloseOnClickOverlay.value = newValue;
    }, {
      immediate: true
    });
    return {
      n,
      classes,
      pack: _locale.pack,
      dt: _shared.dt,
      popupShow,
      popupCloseOnClickOverlay,
      handleClickOverlay,
      confirm,
      cancel
    };
  }

});

exports.default = _default;
"use strict";

exports.__esModule = true;
exports.default = void 0;
exports.render = render;

var _vue = require("vue");

var _loading = _interopRequireDefault(require("../loading"));

var _icon = _interopRequireDefault(require("../icon"));

var _zIndex = require("../context/zIndex");

var _props = require("./props");

var _lock = require("../context/lock");

var _index = require("./index");

var _components = require("../utils/components");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var {
  n,
  classes
} = (0, _components.createNamespace)('snackbar');
var ICON_TYPE_DICT = {
  success: 'checkbox-marked-circle',
  warning: 'warning',
  info: 'information',
  error: 'error',
  loading: ''
};

function render(_ctx, _cache) {
  var _component_var_icon = (0, _vue.resolveComponent)("var-icon");

  var _component_var_loading = (0, _vue.resolveComponent)("var-loading");

  return (0, _vue.withDirectives)(((0, _vue.openBlock)(), (0, _vue.createElementBlock)("div", {
    class: (0, _vue.normalizeClass)(_ctx.n()),
    style: (0, _vue.normalizeStyle)({
      pointerEvents: _ctx.isForbidClick ? 'auto' : 'none',
      zIndex: _ctx.zIndex
    })
  }, [(0, _vue.createElementVNode)("div", {
    class: (0, _vue.normalizeClass)(_ctx.classes(_ctx.n('wrapper'), _ctx.n("wrapper-" + _ctx.position), 'var-elevation--4', [_ctx.vertical, _ctx.n('vertical')], [_ctx.type && _ctx.SNACKBAR_TYPE.includes(_ctx.type), _ctx.n("wrapper-" + _ctx.type)])),
    style: (0, _vue.normalizeStyle)({
      zIndex: _ctx.zIndex
    })
  }, [(0, _vue.createElementVNode)("div", {
    class: (0, _vue.normalizeClass)([_ctx.n('content'), _ctx.contentClass])
  }, [(0, _vue.renderSlot)(_ctx.$slots, "default", {}, () => [(0, _vue.createTextVNode)((0, _vue.toDisplayString)(_ctx.content), 1
  /* TEXT */
  )])], 2
  /* CLASS */
  ), (0, _vue.createElementVNode)("div", {
    class: (0, _vue.normalizeClass)(_ctx.n('action'))
  }, [_ctx.iconName ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_var_icon, {
    key: 0,
    name: _ctx.iconName
  }, null, 8
  /* PROPS */
  , ["name"])) : (0, _vue.createCommentVNode)("v-if", true), _ctx.type === 'loading' ? ((0, _vue.openBlock)(), (0, _vue.createBlock)(_component_var_loading, {
    key: 1,
    type: _ctx.loadingType,
    size: _ctx.loadingSize
  }, null, 8
  /* PROPS */
  , ["type", "size"])) : (0, _vue.createCommentVNode)("v-if", true), (0, _vue.renderSlot)(_ctx.$slots, "action")], 2
  /* CLASS */
  )], 6
  /* CLASS, STYLE */
  )], 6
  /* CLASS, STYLE */
  )), [[_vue.vShow, _ctx.show]]);
}

var _default = (0, _vue.defineComponent)({
  render,
  name: 'VarSnackbarCore',
  components: {
    VarLoading: _loading.default,
    VarIcon: _icon.default
  },
  props: _props.props,

  setup(props) {
    var timer = (0, _vue.ref)(null);
    var {
      zIndex
    } = (0, _zIndex.useZIndex)(() => props.show, 1);
    (0, _lock.useLock)(() => props.show, () => props.lockScroll);
    var isForbidClick = (0, _vue.computed)(() => props.type === 'loading' || props.forbidClick);
    var iconName = (0, _vue.computed)(() => {
      if (!props.type) return '';
      return ICON_TYPE_DICT[props.type];
    });

    var updateAfterDuration = () => {
      timer.value = setTimeout(() => {
        var _props$onUpdateShow;

        props.type !== 'loading' && ((_props$onUpdateShow = props['onUpdate:show']) == null ? void 0 : _props$onUpdateShow.call(props, false));
      }, props.duration);
    };

    (0, _vue.watch)(() => props.show, show => {
      if (show) {
        props.onOpen == null ? void 0 : props.onOpen();
        updateAfterDuration();
      } else if (show === false) {
        clearTimeout(timer.value);
        props.onClose == null ? void 0 : props.onClose();
      }
    });
    (0, _vue.watch)(() => props._update, () => {
      clearTimeout(timer.value);
      updateAfterDuration();
    });
    (0, _vue.onMounted)(() => {
      if (props.show) {
        props.onOpen == null ? void 0 : props.onOpen();
        updateAfterDuration();
      }
    });
    return {
      SNACKBAR_TYPE: _index.SNACKBAR_TYPE,
      n,
      classes,
      zIndex,
      iconName,
      isForbidClick
    };
  }

});

exports.default = _default;